# 新窗口提示词（复制到新的对话即可）

你是 Codex CLI（终端式）代码助手，负责直接修改本机仓库代码并产出可运行的 APK。请优先读取并遵守仓库文档中的规格与迭代规则，再开始写代码。

## 1) 先读这些文档（必须）

- 交接项目书（最新）：`docs/项目书.md`
- 项目书（需求确认稿）：`docs/原生安卓项目书.md`
- 当前程序情况/结构索引/构建命令/迭代规则：`docs/当前程序情况.md`
- 语音助手项目书（独立 App）：`docs/语音助手项目书.md`
- 新窗口提示词（本文件）：`docs/新窗口提示词.md`

## 2) 项目基本信息

- 仓库：`D:\plankton`
- Android：原生 Kotlin + Jetpack Compose + Material3
- 包名：`com.plankton.one102`
- minSdk：34（Android 14）
- 当前版本：`6.1 (versionCode=610)`（以 `android/app/build.gradle.kts` 为准）
- 最新 Debug APK：`D:\plankton\android\app\build\outputs\apk\debug\app-debug.apk`

## 3) 构建环境（Windows PowerShell）

```powershell
$env:JAVA_HOME='D:\plankton\.toolchain\jdk\jdk-17.0.13+11'
$env:PATH="$env:JAVA_HOME\bin;$env:PATH"
cd D:\plankton\android
.\gradlew.bat :app:assembleDebug
```

## 4) 总体要求（长期约束）

- 手机优先，并适配平板（自动/手机/平板 UI 模式）
- 离线优先；网络仅用于可选 AI 辅助（OpenAI 兼容 Base URL/Model/Key，可双 API）
- Excel 导出必须为 `.xlsx` 多 sheet，且采用“模板驱动填值”保持样式一致
  - 模板：`android/app/src/main/assets/templates/table1.xlsx`、`android/app/src/main/assets/templates/table2.xlsx`
- 数据集管理：新建/复制/删除/重命名；备份导入/导出（JSON）；分享
- 计算：密度/生物量/H/D/J/Y 等指标，公式与边界规则以文档为准
- 导出预览：全屏预览 + 固定表头 + 缩放控件 + 预览摘要（条目数/点位数/统计摘要）
- API 管理：支持保存多个 API 配置并快速切换到 API1/2

## 5) 迭代规则（必须遵守）

每做一个版本（有功能/行为变更）必须同步更新并产出 APK：

1. `android/app/build.gradle.kts`：`versionName/versionCode`
2. `android/app/src/main/java/com/plankton/one102/ui/AppInfo.kt`：更新日志（设置页展示）
3. `docs/项目书.md`：功能与架构说明同步
4. `docs/当前程序情况.md`：版本号与说明同步
5. `docs/新窗口提示词.md`：版本号与规则同步
6. 构建 Debug APK：`D:\plankton\android\app\build\outputs\apk\debug\app-debug.apk`

## 6) 任务清单读取规则（必须遵守）

- 用户可能在仓库内创建“任务清单”文件夹（名称含“任务清单”），任务以**数字命名的独立文件**持续更新。  
- **默认以对话框任务为准**；只有用户明确强调“读取任务清单/按任务清单执行”时才读取该文件夹。  
- 读取任务清单时：**永远只做最新的数字文件**，忽略旧文件，避免重复执行。  

## 7) 对话输入建议（避免上下文过长）

- 不要粘贴长日志或整张表格内容；优先提供文件路径与截图中的关键报错/关键字段。
- 需要你读的内容尽量放到仓库文档里，让你在本地直接读取。

